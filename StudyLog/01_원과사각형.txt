25.
04.09 09:00
개와 고양이 마무리 후 원과 사각형 그리기 시작

사용자 정의 함수(WN_PROC) 포인터를 가진 객체를 생성
윈도우에 등록 요청
커널에 있는 객체가 메세지를 받을 때 마다 함수 호출

왼쪽버튼 클릭시:
좌표 가져와서, g_GeoShapeManager의 Add.도형 함수 호출

BaseShape* mShapes[] = new 도형;
동적 할당한 객체를 가르키는 포인터를 배열에 저장

~09:50

04.10

지우기 지우기...
1. 클릭하면 x,y 값 얻을 수 있음
2. 도형도 중점이 있으니까 두 x,y 값의 최소 거리 설정 해두고
3. 체크 함수 만들어서
4. true면 해당 도형 객체를 지우면 되려나?
// 클릭 이벤트 발생시 해당 위치의 객체를 얻어오는 방법은 없을까?

4.10 09:35
드디어 코드 소화 완료
전에 이해한 내용과 동일하지만 좀 더 WIN api 랑 친해졌달까..

좌클릭 -> 좌표 대입 및  g_GeoShapeManager.AddCircle() 호출

m_shapes[] 배열에 Circle 객체 할당

InvalidateRect 호출시 WM_PAINT 메세지 전달

g_GeoShapeManager.Draw(hdc) 호출

 void Draw(HDC hdc) //
 {
     for (int i = 0; i < MAX_SHAPES; ++i)
     {
         if (m_shapes[i] == nullptr) break;

         m_shapes[i]->Draw(hdc);
     }
 }

배열 요소를 순회하며 요소의 Draw 호출


1. 유니티 처럼 무슨 오브젝트가 화면에 존재하는게 아니라 배열에 데이터로 존재함
2. BaseShape* [] 에 업캐스팅 되어 저장되어 있으니 다운캐스팅 해서 좌표 값 가져와서 연산하면 될듯
3. 일단 좌클릭하면 배열 내부 요소를 nullptr로 만드는 것 부터 해볼까 ?

extern ?
cpp에는 네임스페이스 내부에 GSM 인스턴스
헤더에 extern 인스턴스

extern! 동일한 프로젝트에 선언된 지역변수 + 헤더에 선언된 extern을 통해
링커에게 노출시켜 서로 다른 .cpp 임에도 연결 가넝


4.11 15:00
클릭하면 마우스 위치 값 알수 있고
m_shapes의 모든 객체를 다운캐스팅 해서 xy값 가져오고 대조해서 가장 작은 값을 지운다 !

4.12 20:00

x,y 값을 매개변수로 전달하기전에 구조체 배열에다 넣어 버려도 되긴 하지만
객체지향 하지 않음

구조체 pos{ x, y, size } 만들어서
Get Pos 함수 오버라이드
각 도형의 특성에 맞게 함수 정의


GetPos 오버라이드 해도 vt엔 안들어가겠구나
그럼 좌클릭 우클릭 캐스팅을 바꿔야겠네
둘다 구현하기 귀찮은데 방법 없나
오히려 따로 구현 안하면 더 귀찮은듯?

좌클릭시
1. 배열을 순회
3. Getpos
4. 거리계산 ? 해당 배열 지우기 : 그리기 

그러게 업캐스팅 해도 가상함수테이블은 자식꺼 갖고 있으니까
그냥 오버라이드 한거 쓰면 되잖슴 다운캐스팅 할 필요 없네

size 가 반지름이고
반지름 거리보다 거리계산한 값이 

아 잠깐 그냥 오버라이드 해버리니까
얘가 원인지 삼각형인지 모름
아ㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏㅏ

그럼 구조체에다 형태까지 멤버로 넣어야하나 ?
넣어서 짰음...힘들다

draw에서 순회하고 nullptr 만나면 그리고 꽉차면 그리지 않는걸로

4.13
배열 요소 순회하면서 요소의 멤버 변수 갖고오고

모양과 거리를 계산해서 둘다 통과하면 탐지 성공 및 삭제

---

지금 문제점
1. draw가 배열을 순서대로 순회하며 그리기 때문에
중간 인덱스 도형 지워버리면 그 뒤의 요소들도 안그려버림

2. 사각형은 왜 지워짐 대체 ?????
2-1 그리기는 잘 되니 거리 탐지 자체는 잘된다.
2-2 아! GetInfo에서 형태를 안가져와버림

3. ?? 그렸어 또 클릭하면 지워져야하는데 안지워짐 머지
3-1 뭐지 구조체 왜 초기화 안되노 ㄴㄴ 초기화 잘 되고 있음
3-2 어라 지우자 마자 다시 그려버리는데?

0~99 반복
요소가 null이 아니면
요소 멤버 가져와서 비교
비교해서 모냥이랑 거리 조건 맞으면 지우고 카운트 빼기
return true;

제일 가까운거 지우고 반환 맞는디
배열 요소에 암것도 없으면 false 반환 맞는디

지우고 true 반환 했는데 왜 다시 그리지...
"if (!simplegeo::g_GeoShapeManager.DetectGeo(x, y, shape));"

if문 뒤에 붙은 세미콜론 하나 때문에 if문 따로 if문 밑의 지역 따로 호출되고 있었음 레잔도

오 이제 순서대로 지우는건 됨
이제 draw 함수 수정해야된다

for문 2개 만들어서
하나는 중간에 빈 인덱스 찾는거
하나는 그냥 그리는거 하면 되겠는데 ?

빈 인덱스 찾아서 카운트 넣어주니까 막 섞이네
1. 요소에서 null 찾으면 count = i
2. 근데 그릴때 count ++
3. 지울 때 count--

증감연산 하지 말고 그리기 직전에 빈칸 찾아서 거따 그리면 되잖슴

끝남 고생했따 은희야 좀만 쉬자ㅠㅠ













